---
import PageLayout from '@layouts/PageLayout.astro';
import BlogCard from '@components/BlogCard.astro';
import { getCollection } from 'astro:content';
import { useTranslations } from '@i18n/utils';
import type { Lang } from '@i18n/translations';

const lang: Lang = 'en';
const t = useTranslations(lang);

const posts = (await getCollection('blog', ({ data }) => {
  return data.lang === lang && !data.draft;
})).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<PageLayout
  title="Blog | Hustlrr"
  description={t('blog.subtitle')}
  lang={lang}
  canonicalPath="/blog"
>
  <section class="px-5 py-[var(--spacing-section)]">
    <div class="mx-auto max-w-[var(--max-w-content)]">
      <div class="text-center mb-16 animate-reveal">
        <h1 class="text-[var(--text-hero)] font-bold font-[var(--font-display)]">
          {t('blog.title')}
        </h1>
        <p class="text-lg text-text-secondary mt-4 max-w-xl mx-auto">
          {t('blog.subtitle')}
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 animate-stagger">
        {posts.map((post) => (
          <BlogCard
            title={post.data.title}
            description={post.data.description}
            pubDate={post.data.pubDate}
            slug={post.id.replace(/^en\//, '')}
            lang={lang}
          />
        ))}
      </div>
    </div>
  </section>

  <!-- Newsletter signup -->
  <section class="px-5 pb-[var(--spacing-section)]">
    <div class="mx-auto max-w-[600px]" id="blog-listing-newsletter">
      <script is:inline async data-uid="c6d9f0aca8" src="https://hustlrr-ai.kit.com/c6d9f0aca8/index.js"></script>
    </div>
    <style is:inline>
      #blog-listing-newsletter .formkit-form {
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.4) !important;
        border-radius: 24px !important;
        overflow: hidden !important;
        border: 1px solid rgba(255, 255, 255, 0.1) !important;
      }
      #blog-listing-newsletter .formkit-submit {
        border-radius: 20px !important;
      }
      #blog-listing-newsletter .formkit-input {
        border-radius: 12px !important;
      }
      #blog-listing-newsletter .formkit-column {
        border-top: none !important;
      }
    </style>
  </section>
</PageLayout>
